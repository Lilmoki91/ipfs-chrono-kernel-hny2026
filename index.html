<!DOCTYPE html>
<html lang="ms">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>IPFS Terminal Runner Advanced</title>
<style>
body {
  margin:0; padding:0; font-family:'JetBrains Mono', monospace;
  background:#050805; color:#00ff66; height:100vh; overflow:hidden;
}
#terminal {
  padding:16px; height:100vh; box-sizing:border-box;
  overflow:auto; white-space:pre-wrap; word-break:break-word;
  position:relative;
}
.cursor::after {
  content:"▍"; margin-left:2px; animation:blink 1s infinite; color:white;
}
@keyframes blink {0%,50%{opacity:1}51%,100%{opacity:0}}
button {
  position:fixed; bottom:20px; right:20px;
  padding:10px 14px; border-radius:6px; border:none;
  background:#00ff66; color:#000; font-family:inherit;
  font-weight:bold;
}
iframe {width:100%; height:100%; border:none;}
</style>
</head>
<body>

<div id="terminal" class="cursor"></div>
<button id="runBtn">▶ Run</button>

<script>
const terminalEl = document.getElementById('terminal');
const CID = "QmYCbe53x5YDSbKBAoXVXtri4H43ZZy5neUnQMFDtPXvSs";
const GATEWAY = `https://gateway.pinata.cloud/ipfs/${CID}`;

/* Bunyi keyboard */
const sounds = [1,2,3,4].map(i => {
  const s = new Audio(`https://motionape-website.s3.us-east-1.amazonaws.com/Freebies/SoundFX/Sounds/Keyboard/Keyboard-0${i}.mp3`);
  s.volume = 0.12;
  return s;
});

/* TYPE EFFECT with sound */
function typeEffect(el, text, speed=20) {
  return new Promise(resolve=>{
    let i=0;
    const type = ()=>{
      el.textContent += text.charAt(i);
      if(i%3===0){
        const s = sounds[Math.floor(Math.random()*sounds.length)];
        s.currentTime=0; s.play().catch(()=>{});
      }
      i++;
      el.scrollTop = el.scrollHeight;
      if(i<text.length) setTimeout(type, speed + Math.random()*5);
      else resolve();
    };
    type();
  });
}

/* LOADING DOTS EFFECT */
function loadingDots(msg, duration=2000) {
  return new Promise(resolve=>{
    let d=0;
    const interval = setInterval(()=>{
      terminalEl.textContent = `${msg}${'.'.repeat(d%4)}`;
      d++;
      terminalEl.scrollTop = terminalEl.scrollHeight;
    },400);
    setTimeout(()=>{
      clearInterval(interval);
      terminalEl.textContent += "\n";
      resolve();
    }, duration);
  });
}

document.getElementById('runBtn').addEventListener('click', async () => {
  document.getElementById('runBtn').remove();
  
  await loadingDots("</> Fetching import webhook metadata IPFS", 3000);
  await typeEffect(terminalEl,
`CID: ${CID} 
# -------------------------------- 

GATEWAY: ${GATEWAY}
# --------------------------------`, 20);

  try {
    const res = await fetch(GATEWAY);
    const htmlText = await res.text();

    await loadingDots("</> Download complete. Running code happy new year 2026", 2500);

    // Clear terminal before iframe
    terminalEl.innerHTML = "";

    // Render HTML di iframe
    const iframe = document.createElement('iframe');
    iframe.srcdoc = htmlText;
    terminalEl.appendChild(iframe);

  } catch(e) {
    await typeEffect(terminalEl, `Error fetch IPFS: ${e}\n`, 10);
  }
});
</script>

</body>
  </html>
